DROP DATABASE IF EXISTS final_project;
CREATE DATABASE final_project;
USE final_project;


# יוצרים את הטבלאות 
CREATE TABLE Person (
  person_id VARCHAR(9) PRIMARY KEY,
  name VARCHAR(100) NOT NULL
);



CREATE TABLE Customer (
    person_id VARCHAR(9) PRIMARY KEY,
    phone VARCHAR(20),
    FOREIGN KEY (person_id) REFERENCES Person(person_id)
);


CREATE TABLE Author (
	person_id VARCHAR(9) PRIMARY KEY,
    address VARCHAR(255),
    FOREIGN KEY (person_id) REFERENCES Person(person_id)
);



CREATE TABLE Employee (
    person_id VARCHAR(9) PRIMARY KEY,
    role ENUM('Monthly','Hourly') NOT NULL,
    salary DECIMAL(10,2), -- כדי שלא נתקע עם השכר לא היה מספר שלם
    FOREIGN KEY (person_id) REFERENCES Person(person_id)
);


-- Products hierarchy
CREATE TABLE Product (
    product_id INT PRIMARY KEY,
    price DECIMAL(10,2) NOT NULL
); 

CREATE TABLE Newspaper (
    product_id INT PRIMARY KEY,
    publish_date DATE NOT NULL,
    FOREIGN KEY (product_id) REFERENCES Product(product_id)
);


CREATE TABLE Toy (
  product_id INT PRIMARY KEY,
  weight DECIMAL(6,2),
  color VARCHAR(50),
  is_discount BOOLEAN NOT NULL,
  FOREIGN KEY (product_id) REFERENCES Product(product_id)
);

#Including the connection between a writer and a book
CREATE TABLE Book (
    product_id INT PRIMARY KEY,
    title VARCHAR(100) NOT NULL,
    number_of_pages INT NOT NULL,
    author_id VARCHAR(9) NOT NULL,
    FOREIGN KEY (product_id) REFERENCES Product(product_id),
    FOREIGN KEY (author_id) REFERENCES Author(person_id)
);



CREATE TABLE Volume (
    product_id INT NOT NULL,
    volume_letter CHAR(1) NOT NULL,
    PRIMARY KEY (product_id, volume_letter),
    FOREIGN KEY (product_id) REFERENCES Book(product_id)
);


 
-- קשר הקניה 
CREATE TABLE BookPurchase (
  purchase_id INT AUTO_INCREMENT PRIMARY KEY,
  customer_id VARCHAR(9) NOT NULL,
  book_id INT NOT NULL,
  quantity INT NOT NULL,
  FOREIGN KEY (customer_id) REFERENCES Customer(person_id),
  FOREIGN KEY (book_id) REFERENCES Book(product_id)
);


-- Data entry
INSERT INTO Person (person_id,  name) VALUES
('123456789','Daniel Cohen'),
('234567891','Noam Levi'),
('345678912','Itay Mizrahi'),
('456789123','Amit Rosen'),
('567891234','Yonatan Katz'),
('678912345','Eyal Friedman'),
('789123456','Omer Bar'),
('891234567','Lior Shapira'),
('912345678','Tal Gross'),
('102345678','Nadav Amir'),
('112345678','Shai Ben David'),
('122345678','Yuval Goren'),
('132345678','Gil Peretz'),
('142345678','Roi Azulay'),
('152345678','Tomer Avital'),
('162345678','Eran Malka'),
('172345678','Kfir Dayan'),
('182345678','Maor Shalom'),
('192345678','Idan Bittan'),
('202345678','Yossi Tzur'),
('212345678','Avi Nissim'),
('222345678','Barak Hadad'),
('232345678','Matan Aharoni'),
('242345678','Ofir Harel'),
('252345678','Nir Solomon'),
('262345678','Elad Ohayon'),
('272345678','Assaf Mor'),
('282345678','Itzik Ben Shimon'),
('292345678','Hagai Zohar'),
('302345678','Ziv Nahum'),
('312345678','Ran Saadon'),
('322345678','Yoav Koren'),
('332345678','Erez Dahan'),
('342345678','Alon Vaknin'),
('352345678','Eitan Spector'),
('362345678','Dor Ronen'),
('372345678','Nati Azulay'),
('382345678','Moshe Turgeman'),
('392345678','Shimon Tal'),
('402345678','Amir Segal'),
('412345678','Boaz Karni'),
('422345678','Guy Refaeli'),
('432345678','Liron Kedmi'),
('442345678','Oded Peleg'),
('452345678','Yaron Feldman'),
('462345678','Kobi Hazan'),
('472345678','Aviv Shmuel'),
('482345678','Ori Malul'),
('492345678','Nissim Elbaz'),
('502345678','Yehuda Azulay'),
('512345678','Eli Rachamim'),
('522345678','Zohar Michaeli'),
('532345678','Dudi Hacohen'),
('542345678','Rami Peri'),
('552345678','Asher Biton'),
('562345678','Miki Shitrit'),
('572345678','Zachi Nahari'),
('582345678','Ronen Barak'),
('592345678','Eyal Yifrah'),
('602345678','Udi Narkis'),
('612345678','Ariel Cohen'),
('622345678','Netanel Levi'),
('632345678','Shlomi Mizrahi'),
('642345678','Yehonatan Klein'),
('652345678','Amos Berger'),
('662345678','Hanan Elbaz'),
('672345678','Ofer Weiss'),
('682345678','Nadav Gold'),
('692345678','Yoel Green'),
('702345678','Michael Stern'),
('712345678','Aharon Weiss'),
('722345678','Benny Kaplan'),
('732345678','Hillel Frank'),
('742345678','Rafael Cohen'),
('752345678','David Lavi'),
('762345678','Zeev Rosenberg'),
('772345678','Shalom Kadosh'),
('782345678','Yitzhak Mor'),
('792345678','Meir Halperin'),
('802345678','Pinchas Adler'),
('812345678','Chaim Rotman'),
('822345678','Yosef Mandel'),
('832345678','Shmuel Rubin'),
('842345678','Nachman Katz'),
('852345678','Avraham Berger'),
('862345678','Moshe Adler'),
('872345678','Eliezer Goldfarb'),
('882345678','Yaakov Stern'),
('892345678','Tzvi Horowitz'),
('902345678','Menachem Weiss'),
('912345679','Shahar Cohen'),
('922345679','Ayal Ben Yosef'),
('932345679','Lavi Shushan'),
('942345679','Itamar Azulay'),
('952345679','Ori Klein'),
('962345679','Gilad Ron'),
('972345679','Yotam Pnini'),
('982345679','Eden Tal'),
('992345679','Barak Ronen'),
('103234567','Niv Shalev'),
('113234567','Rotem Arieli'),
('123234567','Tom Ben Ari'),
('133234567','Naveh Dror'),
('143234567','Ilan Morag'),
('153234567','Roei Alon'),
('163234567','Ofek Zrihen'),
('173234567','Liam Hadad'),
('183234567','Ido Saad'),
('193234567','Oshri Peretz'),
('203234567','Maayan Ben Shalom'),
('210000001','Ariel Benami'),
('210000002','Noam Shahar'),
('210000003','Itay Lurie'),
('210000004','Omer Barzel'),
('210000005','Eyal Shapira'),
('210000006','Tal Avraham'),
('210000007','Roi Eldar'),
('210000008','Yuval Shani'),
('210000009','Lior Dagan'),
('210000010','Nadav Peled'),
('210000011','Gil Ronen'),
('210000012','Amit Mor'),
('210000013','Ofir Arad'),
('210000014','Matan Kedem'),
('210000015','Daniel Tzur'),
('210000016','Shai Golan'),
('210000017','Erez Hadar'),
('210000018','Yoav Barak'),
('210000019','Dor Amitai'),
('210000020','Nir Shalev'),
('210000021','Elad Koren'),
('210000022','Assaf Tal'),
('210000023','Hagai Stern'),
('210000024','Ziv Cohen'),
('210000025','Boaz Levi'),
('210000026','Ori Ben David'),
('210000027','Eden Shamir'),
('210000028','Rotem Katz'),
('210000029','Liam Gross'),
('210000030','Ido Shitrit'),
('210000031','Naveh Azulay'),
('210000032','Maor Ben Yosef'),
('210000033','Yotam Bar'),
('210000034','Guy Malka'),
('210000035','Oshri Peretz'),
('210000036','Netanel Dror'),
('210000037','Shlomi Dahan'),
('210000038','Itamar Vaknin'),
('210000039','Alon Friedman'),
('210000040','Eitan Segal'),
('210000041','Michael Regev'),
('210000042','Rafael Cohen'),
('210000043','Benny Kaplan'),
('210000044','Shmuel Rubin'),
('210000045','Yaakov Stern'),
('210000046','Moshe Adler'),
('210000047','Avraham Berger'),
('210000048','Chaim Rotman'),
('210000049','Menachem Weiss'),
('210000050','Tzvi Horowitz'),
('210000051','Pinchas Adler'),
('210000052','Nachman Katz'),
('210000053','Hillel Frank'),
('210000054','Zeev Rosenberg'),
('210000055','Shalom Kadosh');



INSERT INTO Author (person_id, address) VALUES
-- 30: לא לקוחות ולא עובדים
('210000026','Tel Aviv'),
('210000027','Haifa'),
('210000028','Jerusalem'),
('210000029','Rishon LeZion'),
('210000030','Petah Tikva'),
('210000031','Netanya'),
('210000032','Ashdod'),
('210000033','Holon'),
('210000034','Bat Yam'),
('210000035','Herzliya'),
('210000036','Beer Sheva'),
('210000037','Eilat'),
('210000038','Tiberias'),
('210000039','Nazareth'),
('210000040','Acre'),
('210000041','Karmiel'),
('210000042','Safed'),
('210000043','Hadera'),
('210000044','Ra''anana'),
('210000045','Kfar Saba'),
('210000046','Modiin'),
('210000047','Yavne'),
('210000048','Lod'),
('210000049','Ramla'),
('210000050','Ofakim'),
('210000051','Dimona'),
('210000052','Arad'),
('210000053','Kiryat Gat'),
('210000054','Kiryat Malachi'),
('210000055','Nes Ziona'),

-- 35: רק עובדים (לא לקוחות)
('113234567','Tel Aviv'),
('123234567','Haifa'),
('133234567','Jerusalem'),
('143234567','Rishon LeZion'),
('153234567','Petah Tikva'),
('163234567','Netanya'),
('173234567','Ashdod'),
('183234567','Holon'),
('193234567','Bat Yam'),
('203234567','Herzliya'),

('210000001','Beer Sheva'),
('210000002','Eilat'),
('210000003','Tiberias'),
('210000004','Nazareth'),
('210000005','Acre'),
('210000006','Karmiel'),
('210000007','Safed'),
('210000008','Hadera'),
('210000009','Ra''anana'),
('210000010','Kfar Saba'),
('210000011','Modiin'),
('210000012','Yavne'),
('210000013','Lod'),
('210000014','Ramla'),
('210000015','Ofakim'),
('210000016','Dimona'),
('210000017','Arad'),
('210000018','Kiryat Gat'),
('210000019','Kiryat Malachi'),
('210000020','Nes Ziona'),
('210000021','Rehovot'),
('210000022','Ramat Gan'),
('210000023','Givatayim'),
('210000024','Bnei Brak'),
('210000025','Jerusalem'),

-- 35: לא משנה מה הם (לקוחות ראשונים אצלך)
('123456789','Tel Aviv'),
('234567891','Haifa'),
('345678912','Jerusalem'),
('456789123','Rishon LeZion'),
('567891234','Petah Tikva'),
('678912345','Netanya'),
('789123456','Ashdod'),
('891234567','Holon'),
('912345678','Bat Yam'),
('102345678','Herzliya'),
('112345678','Beer Sheva'),
('122345678','Eilat'),
('132345678','Tiberias'),
('142345678','Nazareth'),
('152345678','Acre'),
('162345678','Karmiel'),
('172345678','Safed'),
('182345678','Hadera'),
('192345678','Ra''anana'),
('202345678','Kfar Saba'),
('212345678','Modiin'),
('222345678','Yavne'),
('232345678','Lod'),
('242345678','Ramla'),
('252345678','Ofakim'),
('262345678','Dimona'),
('272345678','Arad'),
('282345678','Kiryat Gat'),
('292345678','Kiryat Malachi'),
('302345678','Nes Ziona'),
('312345678','Rehovot'),
('322345678','Ramat Gan'),
('332345678','Givatayim'),
('342345678','Bnei Brak'),
('352345678','Jerusalem');




INSERT INTO Customer (person_id, phone) VALUES
('123456789','050-1111111'),
('234567891','050-1111112'),
('345678912','050-1111113'),
('456789123','050-1111114'),
('567891234','050-1111115'),
('678912345','050-1111116'),
('789123456','050-1111117'),
('891234567','050-1111118'),
('912345678','050-1111119'),
('102345678','050-1111120'),
('112345678','050-1111121'),
('122345678','050-1111122'),
('132345678','050-1111123'),
('142345678','050-1111124'),
('152345678','050-1111125'),
('162345678','050-1111126'),
('172345678','050-1111127'),
('182345678','050-1111128'),
('192345678','050-1111129'),
('202345678','050-1111130'),
('212345678','050-1111131'),
('222345678','050-1111132'),
('232345678','050-1111133'),
('242345678','050-1111134'),
('252345678','050-1111135'),
('262345678','050-1111136'),
('272345678','050-1111137'),
('282345678','050-1111138'),
('292345678','050-1111139'),
('302345678','050-1111140'),
('312345678','050-1111141'),
('322345678','050-1111142'),
('332345678','050-1111143'),
('342345678','050-1111144'),
('352345678','050-1111145'),
('362345678','050-1111146'),
('372345678','050-1111147'),
('382345678','050-1111148'),
('392345678','050-1111149'),
('402345678','050-1111150'),
('412345678','050-1111151'),
('422345678','050-1111152'),
('432345678','050-1111153'),
('442345678','050-1111154'),
('452345678','050-1111155'),
('462345678','050-1111156'),
('472345678','050-1111157'),
('482345678','050-1111158'),
('492345678','050-1111159'),
('502345678','050-1111160'),
('512345678','050-1111161'),
('522345678','050-1111162'),
('532345678','050-1111163'),
('542345678','050-1111164'),
('552345678','050-1111165'),
('562345678','050-1111166'),
('572345678','050-1111167'),
('582345678','050-1111168'),
('592345678','050-1111169'),
('602345678','050-1111170'),
('612345678','050-1111171'),
('622345678','050-1111172'),
('632345678','050-1111173'),
('642345678','050-1111174'),
('652345678','050-1111175'),
('662345678','050-1111176'),
('672345678','050-1111177'),
('682345678','050-1111178'),
('692345678','050-1111179'),
('702345678','050-1111180'),
('712345678','050-1111181'),
('722345678','050-1111182'),
('732345678','050-1111183'),
('742345678','050-1111184'),
('752345678','050-1111185'),
('762345678','050-1111186'),
('772345678','050-1111187'),
('782345678','050-1111188'),
('792345678','050-1111189'),
('802345678','050-1111190'),
('812345678','050-1111191'),
('822345678','050-1111192'),
('832345678','050-1111193'),
('842345678','050-1111194'),
('852345678','050-1111195'),
('862345678','050-1111196'),
('872345678','050-1111197'),
('882345678','050-1111198'),
('892345678','050-1111199'),
('902345678','050-1111200'),
('912345679','050-1111201'),
('922345679','050-1111202'),
('932345679','050-1111203'),
('942345679','050-1111204'),
('952345679','050-1111205'),
('962345679','050-1111206'),
('972345679','050-1111207'),
('982345679','050-1111208'),
('992345679','050-1111209'),
('103234567','050-1111210');


INSERT INTO Employee (person_id, role, salary) VALUES

-- 80 עובדים שהם גם לקוחות (Person 1-80)
('123456789','Monthly',8500.00),
('234567891','Hourly',55.00),
('345678912','Monthly',9200.00),
('456789123','Hourly',60.00),
('567891234','Monthly',8800.00),
('678912345','Hourly',58.00),
('789123456','Monthly',9100.00),
('891234567','Hourly',62.00),
('912345678','Monthly',8700.00),
('102345678','Hourly',57.00),
('112345678','Monthly',9000.00),
('122345678','Hourly',59.00),
('132345678','Monthly',9300.00),
('142345678','Hourly',61.00),
('152345678','Monthly',8900.00),
('162345678','Hourly',56.00),
('172345678','Monthly',9400.00),
('182345678','Hourly',63.00),
('192345678','Monthly',9050.00),
('202345678','Hourly',60.00),
('212345678','Monthly',8600.00),
('222345678','Hourly',54.00),
('232345678','Monthly',9150.00),
('242345678','Hourly',58.00),
('252345678','Monthly',8750.00),
('262345678','Hourly',57.00),
('272345678','Monthly',9050.00),
('282345678','Hourly',61.00),
('292345678','Monthly',8650.00),
('302345678','Hourly',56.00),
('312345678','Monthly',8950.00),
('322345678','Hourly',59.00),
('332345678','Monthly',9250.00),
('342345678','Hourly',60.00),
('352345678','Monthly',8850.00),
('362345678','Hourly',55.00),
('372345678','Monthly',9350.00),
('382345678','Hourly',62.00),
('392345678','Monthly',9000.00),
('402345678','Hourly',58.00),
('412345678','Monthly',8700.00),
('422345678','Hourly',57.00),
('432345678','Monthly',9200.00),
('442345678','Hourly',60.00),
('452345678','Monthly',8800.00),
('462345678','Hourly',56.00),
('472345678','Monthly',9100.00),
('482345678','Hourly',61.00),
('492345678','Monthly',8650.00),
('502345678','Hourly',58.00),
('512345678','Monthly',8950.00),
('522345678','Hourly',59.00),
('532345678','Monthly',9300.00),
('542345678','Hourly',60.00),
('552345678','Monthly',8850.00),
('562345678','Hourly',55.00),
('572345678','Monthly',9400.00),
('582345678','Hourly',63.00),
('592345678','Monthly',9050.00),
('602345678','Hourly',57.00),
('612345678','Monthly',8600.00),
('622345678','Hourly',54.00),
('632345678','Monthly',9150.00),
('642345678','Hourly',58.00),
('652345678','Monthly',8750.00),
('662345678','Hourly',57.00),
('672345678','Monthly',9050.00),
('682345678','Hourly',61.00),
('692345678','Monthly',8650.00),
('702345678','Hourly',56.00),
('712345678','Monthly',8950.00),
('722345678','Hourly',59.00),
('732345678','Monthly',9250.00),
('742345678','Hourly',60.00),
('752345678','Monthly',8850.00),
('762345678','Hourly',55.00),
('772345678','Monthly',9350.00),
('782345678','Hourly',62.00),
('792345678','Monthly',9000.00),
('802345678','Hourly',58.00),
-- 20 עובדים שהם לא לקוחות (Person 101-120)
('912345679','Monthly',9000.00),
('922345679','Hourly',59.00),
('932345679','Monthly',9300.00),
('942345679','Hourly',61.00),
('952345679','Monthly',8900.00),
('962345679','Hourly',56.00),
('972345679','Monthly',9400.00),
('982345679','Hourly',63.00),
('992345679','Monthly',9050.00),
('103234567','Hourly',60.00),
('113234567','Monthly',8700.00),
('123234567','Hourly',57.00),
('133234567','Monthly',9200.00),
('143234567','Hourly',60.00),
('153234567','Monthly',8800.00),
('163234567','Hourly',56.00),
('173234567','Monthly',9100.00),
('183234567','Hourly',61.00),
('193234567','Monthly',8650.00),
('203234567','Hourly',58.00),
('210000001','Monthly',9000.00),
('210000002','Hourly',60.00),
('210000003','Monthly',9200.00),
('210000004','Hourly',58.00),
('210000005','Monthly',8800.00),
('210000006','Hourly',62.00),
('210000007','Monthly',9400.00),
('210000008','Hourly',59.00),
('210000009','Monthly',9100.00),
('210000010','Hourly',57.00),
('210000011','Monthly',8950.00),
('210000012','Hourly',61.00),
('210000013','Monthly',9300.00),
('210000014','Hourly',60.00),
('210000015','Monthly',9050.00),
('210000016','Hourly',56.00),
('210000017','Monthly',9150.00),
('210000018','Hourly',63.00),
('210000019','Monthly',8900.00),
('210000020','Hourly',58.00),
('210000021','Monthly',9250.00),
('210000022','Hourly',60.00),
('210000023','Monthly',9000.00),
('210000024','Hourly',59.00),
('210000025','Monthly',9100.00);

INSERT INTO Product (product_id, price) VALUES
(1001,19.90),(1002,24.50),(1003,15.00),(1004,39.90),(1005,12.90),
(1006,29.90),(1007,55.00),(1008,18.50),(1009,44.90),(1010,22.00),
(1011,16.90),(1012,31.90),(1013,27.50),(1014,49.90),(1015,14.00),
(1016,33.00),(1017,21.90),(1018,59.90),(1019,26.00),(1020,19.00),
(1021,13.50),(1022,28.90),(1023,35.00),(1024,42.90),(1025,17.90),
(1026,23.90),(1027,54.90),(1028,11.90),(1029,36.50),(1030,25.00),
(1031,20.90),(1032,47.90),(1033,32.00),(1034,18.90),(1035,29.00),
(1036,41.00),(1037,16.50),(1038,27.90),(1039,52.00),(1040,24.90),
(1041,14.90),(1042,38.00),(1043,33.90),(1044,19.50),(1045,48.90),
(1046,22.90),(1047,15.90),(1048,57.00),(1049,26.90),(1050,30.00),
(1051,17.00),(1052,43.90),(1053,28.50),(1054,12.50),(1055,39.00),
(1056,21.00),(1057,34.90),(1058,16.00),(1059,50.00),(1060,23.00),
(1061,18.00),(1062,46.00),(1063,31.00),(1064,13.90),(1065,40.90),
(1066,24.00),(1067,15.50),(1068,58.90),(1069,27.00),(1070,29.90),
(1071,19.00),(1072,44.00),(1073,33.00),(1074,14.50),(1075,37.90),
(1076,22.50),(1077,16.90),(1078,56.90),(1079,25.90),(1080,32.90),
(1081,11.00),(1082,49.00),(1083,30.90),(1084,18.00),(1085,41.90),
(1086,26.50),(1087,17.90),(1088,53.00),(1089,24.50),(1090,35.90),
(1091,12.90),(1092,45.50),(1093,29.90),(1094,16.50),(1095,38.90),
(1096,23.50),(1097,19.90),(1098,55.90),(1099,27.90),(1100,31.50),

-- Toys: 1101-1200
(1101,34.90),(1102,29.90),(1103,19.90),(1104,24.90),(1105,39.90),
(1106,21.90),(1107,44.90),(1108,17.90),(1109,26.90),(1110,33.90),
(1111,18.50),(1112,22.90),(1113,27.90),(1114,35.90),(1115,16.90),
(1116,41.90),(1117,25.90),(1118,30.90),(1119,23.50),(1120,28.50),
(1121,20.90),(1122,19.00),(1123,24.00),(1124,32.90),(1125,21.00),
(1126,26.50),(1127,18.00),(1128,37.90),(1129,22.50),(1130,29.00),
(1131,15.90),(1132,33.00),(1133,27.00),(1134,23.00),(1135,31.00),
(1136,24.50),(1137,19.50),(1138,28.90),(1139,34.00),(1140,25.00),
(1141,17.00),(1142,36.90),(1143,21.50),(1144,29.50),(1145,24.90),
(1146,18.90),(1147,32.00),(1148,26.00),(1149,22.00),(1150,35.00),
(1151,19.90),(1152,27.50),(1153,23.90),(1154,31.90),(1155,20.50),
(1156,24.90),(1157,33.50),(1158,18.00),(1159,29.90),(1160,22.90),
(1161,17.90),(1162,34.90),(1163,26.90),(1164,21.90),(1165,30.00),
(1166,24.00),(1167,19.90),(1168,28.00),(1169,32.90),(1170,23.50),
(1171,18.50),(1172,35.90),(1173,25.90),(1174,20.90),(1175,29.00),
(1176,24.50),(1177,19.00),(1178,33.90),(1179,26.50),(1180,22.50),
(1181,17.50),(1182,36.00),(1183,24.90),(1184,21.00),(1185,30.90),
(1186,23.90),(1187,18.90),(1188,34.50),(1189,27.90),(1190,22.90),
(1191,19.90),(1192,32.90),(1193,25.00),(1194,20.00),(1195,29.90),
(1196,24.50),(1197,18.50),(1198,35.00),(1199,26.90),(1200,23.00),

-- Newspapers: 1201-1300
(1201,7.90),(1202,6.90),(1203,8.50),(1204,9.90),(1205,7.50),
(1206,6.50),(1207,8.90),(1208,7.90),(1209,6.90),(1210,9.50),
(1211,7.90),(1212,6.90),(1213,8.50),(1214,9.90),(1215,7.50),
(1216,6.50),(1217,8.90),(1218,7.90),(1219,6.90),(1220,9.50),
(1221,7.90),(1222,6.90),(1223,8.50),(1224,9.90),(1225,7.50),
(1226,6.50),(1227,8.90),(1228,7.90),(1229,6.90),(1230,9.50),
(1231,7.90),(1232,6.90),(1233,8.50),(1234,9.90),(1235,7.50),
(1236,6.50),(1237,8.90),(1238,7.90),(1239,6.90),(1240,9.50),
(1241,7.90),(1242,6.90),(1243,8.50),(1244,9.90),(1245,7.50),
(1246,6.50),(1247,8.90),(1248,7.90),(1249,6.90),(1250,9.50),
(1251,7.90),(1252,6.90),(1253,8.50),(1254,9.90),(1255,7.50),
(1256,6.50),(1257,8.90),(1258,7.90),(1259,6.90),(1260,9.50),
(1261,7.90),(1262,6.90),(1263,8.50),(1264,9.90),(1265,7.50),
(1266,6.50),(1267,8.90),(1268,7.90),(1269,6.90),(1270,9.50),
(1271,7.90),(1272,6.90),(1273,8.50),(1274,9.90),(1275,7.50),
(1276,6.50),(1277,8.90),(1278,7.90),(1279,6.90),(1280,9.50),
(1281,7.90),(1282,6.90),(1283,8.50),(1284,9.90),(1285,7.50),
(1286,6.50),(1287,8.90),(1288,7.90),(1289,6.90),(1290,9.50),
(1291,7.90),(1292,6.90),(1293,8.50),(1294,9.90),(1295,7.50),
(1296,6.50),(1297,8.90),(1298,7.90),(1299,6.90),(1300,9.50);


INSERT INTO Newspaper (product_id, publish_date) VALUES
(1201,'2025-01-01'),
(1202,'2025-01-02'),
(1203,'2025-01-03'),
(1204,'2025-01-04'),
(1205,'2025-01-05'),
(1206,'2025-01-06'),
(1207,'2025-01-07'),
(1208,'2025-01-08'),
(1209,'2025-01-09'),
(1210,'2025-01-10'),
(1211,'2025-01-11'),
(1212,'2025-01-12'),
(1213,'2025-01-13'),
(1214,'2025-01-14'),
(1215,'2025-01-15'),
(1216,'2025-01-16'),
(1217,'2025-01-17'),
(1218,'2025-01-18'),
(1219,'2025-01-19'),
(1220,'2025-01-20'),
(1221,'2025-01-21'),
(1222,'2025-01-22'),
(1223,'2025-01-23'),
(1224,'2025-01-24'),
(1225,'2025-01-25'),
(1226,'2025-01-26'),
(1227,'2025-01-27'),
(1228,'2025-01-28'),
(1229,'2025-01-29'),
(1230,'2025-01-30'),
(1231,'2025-01-31'),
(1232,'2025-02-01'),
(1233,'2025-02-02'),
(1234,'2025-02-03'),
(1235,'2025-02-04'),
(1236,'2025-02-05'),
(1237,'2025-02-06'),
(1238,'2025-02-07'),
(1239,'2025-02-08'),
(1240,'2025-02-09'),
(1241,'2025-02-10'),
(1242,'2025-02-11'),
(1243,'2025-02-12'),
(1244,'2025-02-13'),
(1245,'2025-02-14'),
(1246,'2025-02-15'),
(1247,'2025-02-16'),
(1248,'2025-02-17'),
(1249,'2025-02-18'),
(1250,'2025-02-19'),
(1251,'2025-02-20'),
(1252,'2025-02-21'),
(1253,'2025-02-22'),
(1254,'2025-02-23'),
(1255,'2025-02-24'),
(1256,'2025-02-25'),
(1257,'2025-02-26'),
(1258,'2025-02-27'),
(1259,'2025-02-28'),
(1260,'2025-03-01'),
(1261,'2025-03-02'),
(1262,'2025-03-03'),
(1263,'2025-03-04'),
(1264,'2025-03-05'),
(1265,'2025-03-06'),
(1266,'2025-03-07'),
(1267,'2025-03-08'),
(1268,'2025-03-09'),
(1269,'2025-03-10'),
(1270,'2025-03-11'),
(1271,'2025-03-12'),
(1272,'2025-03-13'),
(1273,'2025-03-14'),
(1274,'2025-03-15'),
(1275,'2025-03-16'),
(1276,'2025-03-17'),
(1277,'2025-03-18'),
(1278,'2025-03-19'),
(1279,'2025-03-20'),
(1280,'2025-03-21'),
(1281,'2025-03-22'),
(1282,'2025-03-23'),
(1283,'2025-03-24'),
(1284,'2025-03-25'),
(1285,'2025-03-26'),
(1286,'2025-03-27'),
(1287,'2025-03-28'),
(1288,'2025-03-29'),
(1289,'2025-03-30'),
(1290,'2025-03-31'),
(1291,'2025-04-01'),
(1292,'2025-04-02'),
(1293,'2025-04-03'),
(1294,'2025-04-04'),
(1295,'2025-04-05'),
(1296,'2025-04-06'),
(1297,'2025-04-07'),
(1298,'2025-04-08'),
(1299,'2025-04-09'),
(1300,'2025-04-10');


INSERT INTO Book (product_id, title, number_of_pages, author_id) VALUES
(1001,'Introduction to Databases',120,'210000026'),
(1002,'Advanced SQL Queries',135,'210000027'),
(1003,'Relational Model Basics',140,'210000028'),
(1004,'Database Design Principles',155,'210000029'),
(1005,'Normalization Explained',160,'210000030'),
(1006,'ER Diagrams in Practice',170,'210000031'),
(1007,'Transactions and Recovery',180,'210000032'),
(1008,'Indexing Techniques',190,'210000033'),
(1009,'Query Optimization',200,'210000034'),
(1010,'Distributed Databases',210,'210000035'),

(1011,'NoSQL Fundamentals',125,'210000036'),
(1012,'Big Data Systems',135,'210000037'),
(1013,'Data Warehousing',145,'210000038'),
(1014,'OLAP and Analytics',155,'210000039'),
(1015,'Database Security',165,'210000040'),
(1016,'Concurrency Control',175,'210000041'),
(1017,'Storage Structures',185,'210000042'),
(1018,'Cloud Databases',195,'210000043'),
(1019,'Transaction Processing',205,'210000044'),
(1020,'Advanced Index Structures',215,'210000045'),

(1021,'SQL for Beginners',122,'210000046'),
(1022,'Practical MySQL',132,'210000047'),
(1023,'PostgreSQL Guide',142,'210000048'),
(1024,'Oracle Database Concepts',152,'210000049'),
(1025,'Schema Design',162,'210000050'),
(1026,'Data Integrity',172,'210000051'),
(1027,'Functional Dependencies',182,'210000052'),
(1028,'BCNF and Beyond',192,'210000053'),
(1029,'Data Modeling',202,'210000054'),
(1030,'Database Constraints',212,'210000055'),

(1031,'Transaction Logs',121,'210000026'),
(1032,'Crash Recovery',131,'210000027'),
(1033,'Distributed Transactions',141,'210000028'),
(1034,'CAP Theorem',151,'210000029'),
(1035,'Scalable Databases',161,'210000030'),
(1036,'Replication Techniques',171,'210000031'),
(1037,'Sharding Explained',181,'210000032'),
(1038,'Consistency Models',191,'210000033'),
(1039,'High Availability',201,'210000034'),
(1040,'Fault Tolerant Systems',211,'210000035'),
(1041,'Intro to Data Systems',123,'210000036'),
(1042,'Database Programming',133,'210000037'),
(1043,'Stored Procedures',143,'210000038'),
(1044,'Triggers and Views',153,'210000039'),
(1045,'Advanced Procedures',163,'210000040'),
(1046,'Performance Tuning',173,'210000041'),
(1047,'Query Execution Plans',183,'210000042'),
(1048,'Cost Based Optimization',193,'210000043'),
(1049,'Parallel Databases',203,'210000044'),
(1050,'Database Internals',213,'210000045'),
(1051,'Introduction to SQL',124,'210000046'),
(1052,'Database Applications',134,'210000047'),
(1053,'Data Consistency',144,'210000048'),
(1054,'Integrity Constraints',154,'210000049'),
(1055,'Relational Algebra',164,'210000050'),
(1056,'Query Languages',174,'210000051'),
(1057,'Data Independence',184,'210000052'),
(1058,'Metadata Management',194,'210000053'),
(1059,'Catalog Systems',204,'210000054'),
(1060,'Advanced Database Topics',214,'210000055'),
(1061,'Transaction Schedules',126,'210000026'),
(1062,'Deadlock Handling',136,'210000027'),
(1063,'Locking Protocols',146,'210000028'),
(1064,'Timestamp Ordering',156,'210000029'),
(1065,'Multiversion Control',166,'210000030'),
(1066,'Serializability Theory',176,'210000031'),
(1067,'Database Algorithms',186,'210000032'),
(1068,'Index Structures',196,'210000033'),
(1069,'Hashing Techniques',206,'210000034'),
(1070,'B-Tree Indexes',216,'210000035'),
(1071,'Database Design Case Studies',127,'210000036'),
(1072,'Enterprise Databases',137,'210000037'),
(1073,'Information Systems',147,'210000038'),
(1074,'Data Processing Systems',157,'210000039'),
(1075,'Large Scale Databases',167,'210000040'),
(1076,'Modern DBMS',177,'210000041'),
(1077,'Database Engines',187,'210000042'),
(1078,'Query Processing',197,'210000043'),
(1079,'Database Performance',207,'210000044'),
(1080,'Advanced DBMS Concepts',217,'210000045'),
(1081,'Intro to Data Modeling',128,'210000046'),
(1082,'Conceptual Design',138,'210000047'),
(1083,'Logical Design',148,'210000048'),
(1084,'Physical Design',158,'210000049'),
(1085,'Database Case Analysis',168,'210000050'),
(1086,'Normalization Forms',178,'210000051'),
(1087,'Lossless Decomposition',188,'210000052'),
(1088,'Dependency Preservation',198,'210000053'),
(1089,'Advanced Normalization',208,'210000054'),
(1090,'Database Theory',218,'210000055'),
(1091,'Data Management Systems',129,'210000026'),
(1092,'Information Management',139,'210000027'),
(1093,'Database Applications II',149,'210000028'),
(1094,'Web Databases',159,'210000029'),
(1095,'Client Server Databases',169,'210000030'),
(1096,'Distributed DBMS',179,'210000031'),
(1097,'Database Middleware',189,'210000032'),
(1098,'Advanced Data Systems',199,'210000033'),
(1099,'Database Engineering',209,'210000034'),
(1100,'Complete Guide to Databases',219,'210000035');



INSERT INTO Volume (product_id, volume_letter) VALUES
(1001,'A'),(1001,'B'),
(1002,'A'),(1002,'B'),
(1003,'A'),(1003,'B'),
(1004,'A'),(1004,'B'),
(1005,'A'),(1005,'B'),
(1006,'A'),(1006,'B'),
(1007,'A'),(1007,'B'),
(1008,'A'),(1008,'B'),
(1009,'A'),(1009,'B'),
(1010,'A'),(1010,'B'),
(1011,'A'),(1011,'B'),
(1012,'A'),(1012,'B'),
(1013,'A'),(1013,'B'),
(1014,'A'),(1014,'B'),
(1015,'A'),(1015,'B'),
(1016,'A'),(1016,'B'),
(1017,'A'),(1017,'B'),
(1018,'A'),(1018,'B'),
(1019,'A'),(1019,'B'),
(1020,'A'),(1020,'B'),
(1021,'A'),(1021,'B'),
(1022,'A'),(1022,'B'),
(1023,'A'),(1023,'B'),
(1024,'A'),(1024,'B'),
(1025,'A'),(1025,'B'),
(1026,'A'),(1026,'B'),
(1027,'A'),(1027,'B'),
(1028,'A'),(1028,'B'),
(1029,'A'),(1029,'B'),
(1030,'A'),(1030,'B'),
(1031,'A'),(1031,'B'),
(1032,'A'),(1032,'B'),
(1033,'A'),(1033,'B'),
(1034,'A'),(1034,'B'),
(1035,'A'),(1035,'B'),
(1036,'A'),(1036,'B'),
(1037,'A'),(1037,'B'),
(1038,'A'),(1038,'B'),
(1039,'A'),(1039,'B'),
(1040,'A'),(1040,'B'),
(1041,'A'),(1041,'B'),
(1042,'A'),(1042,'B'),
(1043,'A'),(1043,'B'),
(1044,'A'),(1044,'B'),
(1045,'A'),(1045,'B'),
(1046,'A'),(1046,'B'),
(1047,'A'),(1047,'B'),
(1048,'A'),(1048,'B'),
(1049,'A'),(1049,'B'),
(1050,'A'),(1050,'B');

INSERT INTO Toy (product_id, weight, color, is_discount) VALUES
(1101,0.45,'Red',TRUE),
(1102,0.60,'Blue',FALSE),
(1103,0.75,'Green',TRUE),
(1104,0.90,'Yellow',FALSE),
(1105,1.10,'Purple',TRUE),
(1106,0.55,'Orange',FALSE),
(1107,1.30,'Black',TRUE),
(1108,0.80,'White',FALSE),
(1109,0.95,'Pink',TRUE),
(1110,1.20,'Brown',FALSE),
(1111,0.50,'Red',TRUE),
(1112,0.65,'Blue',FALSE),
(1113,0.70,'Green',TRUE),
(1114,0.85,'Yellow',FALSE),
(1115,1.00,'Purple',TRUE),
(1116,0.58,'Orange',FALSE),
(1117,1.25,'Black',TRUE),
(1118,0.82,'White',FALSE),
(1119,0.98,'Pink',TRUE),
(1120,1.15,'Brown',FALSE),
(1121,0.47,'Red',TRUE),
(1122,0.62,'Blue',FALSE),
(1123,0.77,'Green',TRUE),
(1124,0.92,'Yellow',FALSE),
(1125,1.05,'Purple',TRUE),
(1126,0.57,'Orange',FALSE),
(1127,1.28,'Black',TRUE),
(1128,0.83,'White',FALSE),
(1129,0.97,'Pink',TRUE),
(1130,1.18,'Brown',FALSE),
(1131,0.49,'Red',TRUE),
(1132,0.66,'Blue',FALSE),
(1133,0.73,'Green',TRUE),
(1134,0.88,'Yellow',FALSE),
(1135,1.08,'Purple',TRUE),
(1136,0.59,'Orange',FALSE),
(1137,1.22,'Black',TRUE),
(1138,0.81,'White',FALSE),
(1139,0.96,'Pink',TRUE),
(1140,1.12,'Brown',FALSE),
(1141,0.52,'Red',TRUE),
(1142,0.68,'Blue',FALSE),
(1143,0.74,'Green',TRUE),
(1144,0.89,'Yellow',FALSE),
(1145,1.02,'Purple',TRUE),
(1146,0.61,'Orange',FALSE),
(1147,1.27,'Black',TRUE),
(1148,0.84,'White',FALSE),
(1149,0.99,'Pink',TRUE),
(1150,1.16,'Brown',FALSE),
(1151,0.46,'Red',TRUE),
(1152,0.63,'Blue',FALSE),
(1153,0.78,'Green',TRUE),
(1154,0.93,'Yellow',FALSE),
(1155,1.06,'Purple',TRUE),
(1156,0.56,'Orange',FALSE),
(1157,1.29,'Black',TRUE),
(1158,0.85,'White',FALSE),
(1159,0.94,'Pink',TRUE),
(1160,1.14,'Brown',FALSE),
(1161,0.48,'Red',TRUE),
(1162,0.64,'Blue',FALSE),
(1163,0.76,'Green',TRUE),
(1164,0.91,'Yellow',FALSE),
(1165,1.04,'Purple',TRUE),
(1166,0.60,'Orange',FALSE),
(1167,1.24,'Black',TRUE),
(1168,0.86,'White',FALSE),
(1169,0.95,'Pink',TRUE),
(1170,1.17,'Brown',FALSE),
(1171,0.51,'Red',TRUE),
(1172,0.67,'Blue',FALSE),
(1173,0.72,'Green',TRUE),
(1174,0.87,'Yellow',FALSE),
(1175,1.01,'Purple',TRUE),
(1176,0.62,'Orange',FALSE),
(1177,1.26,'Black',TRUE),
(1178,0.88,'White',FALSE),
(1179,0.93,'Pink',TRUE),
(1180,1.19,'Brown',FALSE),
(1181,0.44,'Red',TRUE),
(1182,0.61,'Blue',FALSE),
(1183,0.79,'Green',TRUE),
(1184,0.94,'Yellow',FALSE),
(1185,1.07,'Purple',TRUE),
(1186,0.58,'Orange',FALSE),
(1187,1.23,'Black',TRUE),
(1188,0.87,'White',FALSE),
(1189,0.92,'Pink',TRUE),
(1190,1.13,'Brown',FALSE),
(1191,0.53,'Red',TRUE),
(1192,0.69,'Blue',FALSE),
(1193,0.71,'Green',TRUE),
(1194,0.86,'Yellow',FALSE),
(1195,1.03,'Purple',TRUE),
(1196,0.63,'Orange',FALSE),
(1197,1.21,'Black',TRUE),
(1198,0.89,'White',FALSE),
(1199,0.91,'Pink',TRUE),
(1200,1.10,'Brown',FALSE);


INSERT INTO BookPurchase (customer_id, book_id, quantity) VALUES
('123456789',1001,1),
('234567891',1001,1),
('345678912',1001,2),
('456789123',1001,1),
('567891234',1001,1),
('678912345',1001,2),
('678912345',1004,2),
('678912345',1005,2),
('789123456',1001,1),
('891234567',1001,1),
('912345678',1001,2),
('102345678',1001,1),
('912345678',1022,2),
('102345678',1021,1),
('112345678',1001,1),
('122345678',1001,2),
('132345678',1001,1),
('142345678',1001,1),
('152345678',1001,2),
('162345678',1001,1),
('172345678',1001,1),
('182345678',1001,2),
('192345678',1001,1),
('202345678',1001,1),
('212345678',1001,1),
('222345678',1001,2),
('232345678',1001,1),
('242345678',1001,1),
('252345678',1001,2),
('262345678',1001,1),
('272345678',1001,1),
('282345678',1001,2),
('292345678',1001,1),
('302345678',1001,1),
('312345678',1001,1),
('322345678',1089,2),
('332345678',1099,1),
('342345678',1030,1),
('352345678',1003,2),
('362345678',1031,1),
('372345678',1010,1),
('382345678',1014,2),
('322345678',1001,2),
('332345678',1001,1),
('342345678',1001,1),
('352345678',1001,2),
('362345678',1001,1),
('372345678',1001,1),
('382345678',1001,2),
('392345678',1001,1),
('402345678',1001,1),
('412345678',1001,1),
('422345678',1001,2),
('432345678',1001,1),
('442345678',1001,1),
('452345678',1001,2),
('462345678',1001,1),
('472345678',1001,1),
('482345678',1001,2),
('492345678',1001,1),
('502345678',1001,1),
('512345678',1001,1),
('522345678',1001,2),
('532345678',1001,1),
('542345678',1001,1),
('552345678',1001,2),
('562345678',1001,1),
('572345678',1001,1),
('582345678',1001,2),
('592345678',1001,1),
('602345678',1001,1),
('612345678',1001,1),
('622345678',1001,2),
('632345678',1001,1),
('642345678',1001,1),
('652345678',1001,2),
('662345678',1001,1),
('672345678',1001,1),
('682345678',1001,2),
('692345678',1001,1),
('702345678',1001,1),
('712345678',1001,1),
('722345678',1001,2),
('732345678',1001,1),
('742345678',1001,1),
('752345678',1001,2),
('762345678',1001,1),
('772345678',1001,1),
('782345678',1001,2),
('792345678',1001,1),
('802345678',1001,1),
('812345678',1001,1),
('822345678',1001,2),
('832345678',1001,1),
('842345678',1001,1),
('852345678',1001,2),
('862345678',1001,1),
('872345678',1001,1),
('882345678',1001,2),
('892345678',1001,1),
('902345678',1001,1),
('912345679',1001,1),
('922345679',1001,2),
('932345679',1001,1),
('942345679',1001,1),
('952345679',1001,2),
('962345679',1001,1),
('972345679',1001,1),
('982345679',1001,2),
('992345679',1001,1),
('103234567',1001,1);




SELECT DISTINCT p.name
FROM Person p
JOIN Customer c ON p.person_id = c.person_id
WHERE c.person_id NOT IN (
    SELECT bp.customer_id
    FROM BookPurchase bp
    JOIN Book b ON bp.book_id = b.product_id
    WHERE b.product_id NOT IN (
        SELECT v.product_id
        FROM Volume v
        GROUP BY v.product_id
        HAVING COUNT(*) = 2
    )
);


SELECT DISTINCT b.product_id, b.title
FROM Book b
WHERE NOT EXISTS (
    SELECT 1
    FROM Customer c
    WHERE NOT EXISTS (
        SELECT 1
        FROM BookPurchase bp
        WHERE bp.book_id = b.product_id
          AND bp.customer_id = c.person_id
    )
);

SELECT
    c.person_id AS customer_id,
    p.name,
    SUM(bp.quantity * pr.price) AS total_spent,
    COUNT(*) AS num_purchases,
    SUM(bp.quantity) AS total_books_bought
FROM Customer c
JOIN Person p        ON p.person_id = c.person_id
JOIN BookPurchase bp ON bp.customer_id = c.person_id
JOIN Product pr      ON pr.product_id = bp.book_id
GROUP BY c.person_id, p.name
ORDER BY total_spent DESC;


SELECT
    a.person_id AS author_id,
    p.name AS author_name,
    COUNT(*) AS num_books,
    AVG(b.number_of_pages) AS avg_pages,
    MAX(b.number_of_pages) AS max_pages
FROM Author a
JOIN Person p ON p.person_id = a.person_id
JOIN Book b   ON b.author_id = a.person_id
GROUP BY a.person_id, p.name
HAVING COUNT(*) >= 3
ORDER BY num_books DESC, avg_pages DESC;






